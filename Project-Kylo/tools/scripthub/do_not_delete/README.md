# ScriptHub DO NOT DELETE - Vendored into Kylo

**Origin:** `D:\ScriptHub\DO NOT DELETE\scripts\`  
**Vendored Date:** 2026-01-27  
**Purpose:** Critical scripts for maintaining Company IDs and JGDTRUTH dynamic columns

## Why Vendored

These scripts were vendored into Kylo to:
- Remove external path dependencies (fragile absolute paths)
- Ensure Kylo has complete, up-to-date copies
- Enable scheduled tasks to use repo-relative paths
- Maintain clear separation from legacy `scripthub_legacy` code

## Scripts

### Core Sync Scripts

1. **`scripts/sync_bank.py`**
   - Applies Kylo_Config rules to CLEAN TRANSACTIONS sheet (Clean Key â†’ Company ID)
   - Usage: `python scripts/sync_bank.py [--config config/config.json] [--dry-run]`

2. **`scripts/sync_company_ids.py`**
   - Syncs Company ID values from BANK sheet to CLEAN TRANSACTIONS sheet
   - Usage: `python scripts/sync_company_ids.py [--credentials config/service_account.json] [--dry-run]`

3. **`scripts/dynamic_columns_jgdtruth.py`**
   - Dynamically maps headers and columns from Google Sheets for JGDTRUTH sheets
   - Usage: `python scripts/dynamic_columns_jgdtruth.py [--summary]`

4. **`scripts/run_both_syncs.py`**
   - Bundled script that runs all three sync scripts sequentially
   - Usage: `python scripts/run_both_syncs.py`

5. **`scripts/server.py`**
   - FastAPI webhook server for ScriptHub services (port 8000)
   - Usage: `uvicorn server:app --host 0.0.0.0 --port 8000`

### Utility Scripts

- `scripts/rule_loader_jgdtruth.py` - Loads JGD Truth rules from Excel file
- `scripts/clear_provenance.py` - Clears provenance column
- `scripts/diag_cols.py` - Diagnoses column structure
- `scripts/set_validation.py` - Sets data validation rules
- `scripts/gui_scheduler.py` - GUI for managing Windows Task Scheduler tasks

## Scheduled Tasks

These scripts should be called by Windows Task Scheduler using the wrapper:

**Task Name:** `KyloSyncPeriodic` (or similar)

**Command:**
```powershell
powershell.exe -ExecutionPolicy Bypass -File "D:\Project-Kylo\tools\scripthub\do_not_delete\run.ps1"
```

Or directly:
```powershell
python.exe "D:\Project-Kylo\tools\scripthub\do_not_delete\scripts\run_both_syncs.py"
```

## Configuration

- **Config File:** `config/config.json`
- **Service Account:** `config/service_account.json` (must be provided separately)
- **Layout Map:** `config/layout_map.json` (generated by dynamic_columns script)

## Dependencies

All scripts require:
- Python 3.11+
- `google-auth`, `google-api-python-client` (for Google Sheets API)
- `gspread` (for some scripts)
- `pandas` (for dynamic_columns)
- `openpyxl` (for rule_loader)
- `fastapi`, `uvicorn` (for server)

## Path Resolution

All scripts use relative paths resolved from their location:
- Scripts resolve `config/` relative to `scripts/` parent directory
- `src/` module is imported from parent directory
- Logs are written to `logs/` in parent directory

## Migration Notes

- Hardcoded paths to `D:\ScriptHub` have been removed
- All paths are now resolved relative to script location
- `runner_sync_bank.pyw` was updated to use relative path resolution

## Testing

Run the smoke test to verify all files exist and imports work:

```powershell
.\smoke_test.ps1
```
